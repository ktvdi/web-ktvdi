{% extends 'base.html' %}
{% block title %}Jadwal Sholat - KTVDI{% endblock %}
{% block content %}
<div class="min-h-screen bg-brand-surface py-12 px-4 font-['Plus_Jakarta_Sans']">
    <div class="max-w-4xl mx-auto bg-white rounded-3xl shadow-xl border border-slate-100 p-8">
        <h1 class="text-3xl font-extrabold text-brand-navy text-center mb-8">Jadwal Sholat & Imsakiyah</h1>
        <div class="mb-8">
            <select id="kotaSelect" onchange="loadJadwal()" class="block w-full p-4 border border-slate-200 rounded-xl bg-slate-50 font-bold text-slate-700 focus:ring-2 focus:ring-brand-blue cursor-pointer">
                <option value="" selected disabled>-- Pilih Lokasi Anda (50 Kota) --</option>
                {% for kota in daftar_kota %}
                <option value="{{ kota.id }}">{{ kota.nama }}</option>
                {% endfor %}
            </select>
        </div>
        
        <div id="loading" class="hidden text-center py-8">
            <i class="fa-solid fa-circle-notch fa-spin text-4xl text-brand-blue"></i>
            <p class="text-slate-400 mt-2">Mengambil data...</p>
        </div>

        <div id="jadwalResult" class="hidden">
            <div class="text-center mb-8">
                <h2 id="namaKotaDisplay" class="text-2xl font-bold text-brand-navy"></h2>
                <p class="text-slate-500 text-sm">Waktu Indonesia Barat/Tengah/Timur</p>
            </div>
            
            <div class="grid grid-cols-2 md:grid-cols-3 gap-6 text-center">
                <div class="bg-blue-50 p-6 rounded-2xl border border-blue-100 hover:shadow-md transition">
                    <div class="text-xs text-slate-500 font-bold tracking-widest mb-1">IMSAK</div>
                    <div id="imsak" class="text-2xl font-extrabold text-brand-navy">--:--</div>
                    <i class="fa-solid fa-mug-hot text-blue-300 mt-2"></i>
                </div>

                <div class="bg-slate-50 p-6 rounded-2xl border border-slate-100 hover:shadow-md transition">
                    <div class="text-xs text-slate-500 font-bold tracking-widest mb-1">SUBUH</div>
                    <div id="subuh" class="text-2xl font-extrabold text-brand-navy">--:--</div>
                    <i class="fa-solid fa-cloud-sun text-slate-300 mt-2"></i>
                </div>

                <div class="bg-slate-50 p-6 rounded-2xl border border-slate-100 hover:shadow-md transition">
                    <div class="text-xs text-slate-500 font-bold tracking-widest mb-1">DZUHUR</div>
                    <div id="dzuhur" class="text-2xl font-extrabold text-brand-navy">--:--</div>
                    <i class="fa-solid fa-sun text-yellow-400 mt-2"></i>
                </div>

                <div class="bg-slate-50 p-6 rounded-2xl border border-slate-100 hover:shadow-md transition">
                    <div class="text-xs text-slate-500 font-bold tracking-widest mb-1">ASHAR</div>
                    <div id="ashar" class="text-2xl font-extrabold text-brand-navy">--:--</div>
                    <i class="fa-solid fa-sun-plant-wilt text-orange-300 mt-2"></i>
                </div>

                <div class="bg-brand-navy p-6 rounded-2xl border border-brand-navy shadow-lg transform scale-105 ring-4 ring-brand-navy/10 relative overflow-hidden">
                    <div class="absolute inset-0 bg-brand-blue opacity-10"></div>
                    <div class="relative z-10">
                        <div class="text-xs text-brand-sky font-bold tracking-widest mb-1">MAGHRIB</div>
                        <div id="maghrib" class="text-2xl font-extrabold text-white">--:--</div>
                        <i class="fa-solid fa-moon text-brand-sky mt-2"></i>
                    </div>
                </div>

                <div class="bg-slate-50 p-6 rounded-2xl border border-slate-100 hover:shadow-md transition">
                    <div class="text-xs text-slate-500 font-bold tracking-widest mb-1">ISYA</div>
                    <div id="isya" class="text-2xl font-extrabold text-brand-navy">--:--</div>
                    <i class="fa-solid fa-star text-indigo-300 mt-2"></i>
                </div>
            </div>
            
            <div class="mt-8 text-center text-xs text-slate-400">
                <i class="fa-solid fa-circle-info mr-1"></i> Data bersumber dari Kemenag RI via MyQuran API. Tambahkan waktu ihtiyati Â± 2 menit.
            </div>
        </div>
    </div>
</div>

<script>
    function loadJadwal() {
        const id = document.getElementById('kotaSelect').value;
        const nama = document.getElementById('kotaSelect').options[document.getElementById('kotaSelect').selectedIndex].text;
        
        document.getElementById('loading').classList.remove('hidden');
        document.getElementById('jadwalResult').classList.add('hidden');

        fetch(`/api/jadwal-sholat/${id}`).then(r=>r.json()).then(d=>{
            const j = d.data.jadwal;
            document.getElementById('namaKotaDisplay').innerText = nama + " - " + j.tanggal;
            
            // Isi Data
            document.getElementById('imsak').innerText = j.imsak;
            document.getElementById('subuh').innerText = j.subuh;
            document.getElementById('dzuhur').innerText = j.dzuhur;
            document.getElementById('ashar').innerText = j.ashar;
            document.getElementById('maghrib').innerText = j.maghrib;
            document.getElementById('isya').innerText = j.isya;
            
            document.getElementById('loading').classList.add('hidden');
            document.getElementById('jadwalResult').classList.remove('hidden');
        });
    }
</script>
{% endblock %}
