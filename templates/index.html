{% extends 'base.html' %}

{% block content %}

<style>
    /* Animasi Glossy / Mengkilat Bergerak */
    @keyframes textShine {
        0% { background-position: 0% 50%; }
        100% { background-position: 200% 50%; }
    }
    
    .text-glossy-effect {
        /* Gradasi warna: Biru Tua -> Putih (Kilau) -> Biru Muda -> Biru Tua */
        background: linear-gradient(
            to right,
            #0f172a 0%,   /* Navy */
            #2563eb 20%,  /* Blue */
            #ffffff 50%,  /* PUTIH (Kilau) */
            #2563eb 80%,  /* Blue */
            #0f172a 100%  /* Navy */
        );
        background-size: 200% auto;
        color: #0f172a; /* Fallback */
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        animation: textShine 3s linear infinite;
        font-weight: 800;
        display: inline-block;
    }

    /* Animasi Wave Audio */
    @keyframes wave {
        0%, 100% { height: 4px; }
        50% { height: 16px; }
    }
</style>

<section class="relative bg-white pt-20 pb-28 overflow-hidden">
    <div class="absolute top-0 right-0 w-[800px] h-[800px] bg-brand-surface rounded-full blur-3xl opacity-60 -mr-20 -mt-20 z-0"></div>
    
    <div class="max-w-7xl mx-auto px-4 relative z-10">
        <div class="flex flex-col lg:flex-row items-center gap-16">
            <div class="flex-1 text-center lg:text-left">
                <div class="inline-flex items-center gap-2 px-4 py-1.5 bg-blue-50 border border-blue-100 text-brand-blue text-xs font-bold rounded-full mb-6 shadow-sm animate-pulse">
                    <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                    Revolusi Penyiaran Indonesia
                </div>
                
                <h1 class="text-4xl md:text-6xl font-extrabold text-brand-navy leading-tight mb-6 tracking-tight">
                    Selamat Datang di <br> 
                    <span class="text-glossy-effect pb-2">
                        Komunitas TV Digital Indonesia
                    </span>
                </h1>
                
                <p class="text-slate-500 text-lg mb-8 max-w-2xl mx-auto lg:mx-0 leading-relaxed text-justify">
                    Sudah saatnya kita meninggalkan era analog yang penuh "semut" dan beralih ke siaran yang jernih, canggih, dan merata. KTVDI hadir sebagai jembatan informasi agar setiap keluarga Indonesia mendapatkan hak siaran yang jernih, canggih, dan gratis.
                </p>
                
                <div class="flex flex-wrap gap-4 justify-center lg:justify-start">
                    <a href="/daftar-siaran" class="px-8 py-4 bg-brand-blue text-white font-bold rounded-xl shadow-xl hover:bg-blue-700 transition flex items-center gap-2 transform hover:-translate-y-1">
                        <i class="fa-solid fa-tower-broadcast"></i> Cek Sinyal Digital
                    </a>
                    {% if not session.get('user') %}
                    <a href="/register" class="px-8 py-4 bg-white border border-slate-200 text-brand-navy font-bold rounded-xl hover:border-brand-blue hover:text-brand-blue transition flex items-center gap-2">
                        <i class="fa-solid fa-user-plus"></i> Gabung Komunitas
                    </a>
                    {% endif %}
                </div>
            </div>
            
            <div class="flex-1 w-full max-w-md">
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-white p-6 rounded-2xl shadow-lg border border-slate-100 text-center hover:border-brand-blue transition group transform hover:-translate-y-1">
                        <div class="text-4xl font-extrabold text-brand-navy group-hover:text-brand-blue transition">{{ stats.wilayah }}</div>
                        <div class="text-xs text-slate-400 font-bold uppercase mt-1">Wilayah Terjangkau</div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-lg border border-slate-100 text-center hover:border-brand-blue transition group transform hover:-translate-y-1">
                        <div class="text-4xl font-extrabold text-brand-navy group-hover:text-brand-blue transition">{{ stats.mux }}</div>
                        <div class="text-xs text-slate-400 font-bold uppercase mt-1">MUX Beroperasi</div>
                    </div>
                    <div class="col-span-2 bg-brand-navy p-8 rounded-2xl shadow-xl text-center text-white relative overflow-hidden group transform hover:-translate-y-1">
                        <div class="absolute top-0 right-0 w-40 h-40 bg-brand-blue rounded-full blur-3xl opacity-20 group-hover:opacity-40 transition"></div>
                        <div class="relative z-10">
                            <div class="text-6xl font-extrabold text-brand-sky mb-2 group-hover:scale-110 transition duration-300">{{ stats.channel }}</div>
                            <div class="text-sm text-slate-300 font-bold uppercase tracking-widest">Total Channel Nasional</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="py-24 bg-slate-900 border-y border-slate-800 relative overflow-hidden">
    <div class="absolute top-0 left-1/2 -translate-x-1/2 w-full max-w-3xl h-64 bg-brand-blue/5 blur-[100px] rounded-full"></div>

    <div class="max-w-7xl mx-auto px-4 relative z-10">
        <div class="text-center mb-16">
            <span class="text-brand-sky font-bold text-xs uppercase tracking-[0.2em] bg-slate-800/50 px-4 py-2 rounded-full border border-slate-700/50 backdrop-blur-sm">Official Stream</span>
            <h2 class="text-3xl md:text-4xl font-extrabold text-white mt-6 tracking-tight">Nonton Siaran TV FTA Indonesia</h2>
            <p class="text-slate-400 mt-3 max-w-2xl mx-auto">Anda bisa menyaksikan Saluran pilihan TV FTA di Indonesia, kapan saja dimana saja dalam genggaman.</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8" id="tv-grid"></div>
    </div>
</section>

<section class="py-24 bg-white font-['Plus_Jakarta_Sans']">
    <div class="max-w-6xl mx-auto px-4">
        
        <div class="text-center mb-20">
            <h2 class="text-4xl font-extrabold text-brand-navy mb-6">Kenapa Harus TV Digital?</h2>
            <p class="text-slate-500 text-lg max-w-3xl mx-auto leading-relaxed">
                Dulu, nonton TV itu identik dengan gambar "semut" dan suara kresek-kresek saat hujan turun. 
                Kini, era itu sudah berakhir. TV Digital hadir membawa revolusi kualitas gambar yang bening, suara jernih, dan teknologi canggihâ€”semuanya Gratis.
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-12 items-start">
            
            <div class="lg:col-span-7 space-y-10">
                
                <div class="flex gap-5">
                    <div class="flex-shrink-0 w-12 h-12 rounded-xl bg-blue-100 flex items-center justify-center text-brand-blue shadow-sm">
                        <i class="fa-solid fa-tv text-xl"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-brand-navy mb-2">Bukan Streaming, Bukan Langganan</h3>
                        <p class="text-slate-600 leading-relaxed text-justify">
                            Banyak yang salah kaprah. TV Digital (DVB-T2) itu <strong>bukan streaming internet</strong> yang boros kuota, dan <strong>bukan TV kabel</strong> yang bayar bulanan. Ini adalah siaran terestrial biasa yang ditangkap pakai antena UHF, tapi teknologinya sudah digital. Sekali beli perangkat (STB/Antena), nontonnya gratis selamanya.
                        </p>
                    </div>
                </div>

                <div class="flex gap-5">
                    <div class="flex-shrink-0 w-12 h-12 rounded-xl bg-purple-100 flex items-center justify-center text-purple-600 shadow-sm">
                        <i class="fa-solid fa-tower-cell text-xl"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-brand-navy mb-2">Konsep "MUX" (Bus Sekolah)</h3>
                        <p class="text-slate-600 leading-relaxed text-justify">
                            Bayangkan frekuensi analog dulu seperti mobil pribadi: 1 frekuensi cuma muat 1 channel TV. Boros jalanan! 
                            <br>
                            Nah, TV Digital menggunakan sistem <strong>MUX (Multiplexing)</strong> yang ibarat "Bus Sekolah". Satu frekuensi MUX bisa mengangkut 6-12 channel TV sekaligus dengan kualitas HD. Makanya sekarang channel TV jadi jauh lebih banyak.
                        </p>
                    </div>
                </div>

                <div class="flex gap-5">
                    <div class="flex-shrink-0 w-12 h-12 rounded-xl bg-orange-100 flex items-center justify-center text-orange-600 shadow-sm">
                        <i class="fa-solid fa-wave-square text-xl"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-brand-navy mb-2">Keajaiban Frekuensi 700 MHz</h3>
                        <p class="text-slate-600 leading-relaxed text-justify">
                            Indonesia memilih frekuensi emas <strong>700 MHz</strong> untuk siaran digital. Kenapa emas? Karena frekuensi ini punya daya tembus yang luar biasa. Sinyalnya bisa menembus tembok tebal gedung perkotaan, tapi juga bisa melesat jauh menjangkau pelosok desa dan pegunungan. Ini kunci pemerataan informasi.
                        </p>
                    </div>
                </div>

            </div>

            <div class="lg:col-span-5 space-y-4">
                <h3 class="text-lg font-bold text-slate-400 uppercase tracking-wider mb-4">Pertanyaan Populer</h3>

                <details class="group bg-white p-5 rounded-2xl border border-slate-200 shadow-sm open:shadow-md transition-all duration-300">
                    <summary class="flex justify-between items-center font-bold text-brand-navy cursor-pointer list-none select-none">
                        Kenapa Sinyal Saya "Cekot-Cekot"?
                        <span class="transition-transform duration-300 group-open:rotate-180 text-brand-blue"><i class="fa-solid fa-chevron-down"></i></span>
                    </summary>
                    <div class="text-slate-600 text-sm mt-4 text-justify leading-relaxed border-t border-slate-100 pt-4">
                        <p class="mb-2">Berbeda dengan analog yang kalau sinyal lemah jadi "semut", TV Digital itu sifatnya 0 atau 1. Kalau sinyal kurang dikit aja, gambar langsung macet/hilang.</p>
                        <strong>Solusi:</strong>
                        <ul class="list-disc pl-5 mt-1 space-y-1">
                            <li>Wajib pakai Antena Outdoor (jangan indoor).</li>
                            <li>Ganti kabel antena lama yang sudah getas dengan kabel RG6 baru.</li>
                            <li>Cek jack konektor, pastikan tidak karatan.</li>
                        </ul>
                    </div>
                </details>

                <details class="group bg-white p-5 rounded-2xl border border-slate-200 shadow-sm open:shadow-md transition-all duration-300">
                    <summary class="flex justify-between items-center font-bold text-brand-navy cursor-pointer list-none select-none">
                        Apa itu EWS di STB?
                        <span class="transition-transform duration-300 group-open:rotate-180 text-brand-blue"><i class="fa-solid fa-chevron-down"></i></span>
                    </summary>
                    <div class="text-slate-600 text-sm mt-4 text-justify leading-relaxed border-t border-slate-100 pt-4">
                        <p><strong>Early Warning System (EWS)</strong> adalah fitur penyelamat nyawa. Saat ada bencana (gempa/tsunami), siaran TV akan otomatis terhenti dan digantikan peringatan dini dari pemerintah sesuai Kode Pos yang Anda masukkan di STB.</p>
                    </div>
                </details>

                <details class="group bg-white p-5 rounded-2xl border border-slate-200 shadow-sm open:shadow-md transition-all duration-300">
                    <summary class="flex justify-between items-center font-bold text-brand-navy cursor-pointer list-none select-none">
                        Cara Nonton Piala Dunia 2026?
                        <span class="transition-transform duration-300 group-open:rotate-180 text-brand-blue"><i class="fa-solid fa-chevron-down"></i></span>
                    </summary>
                    <div class="text-slate-600 text-sm mt-4 text-justify leading-relaxed border-t border-slate-100 pt-4">
                        <p>Hak siar jalur terestrial (UHF) dipegang oleh <strong>TVRI</strong>. Jadi, pastikan antena Anda mengarah ke pemancar TVRI terdekat untuk menikmati pertandingan secara Gratis dan HD.</p>
                    </div>
                </details>

                <div class="mt-8 pt-4">
                    <div class="bg-gradient-to-br from-brand-navy to-slate-800 text-white p-6 rounded-2xl relative overflow-hidden shadow-xl">
                        <div class="absolute top-0 right-0 w-32 h-32 bg-white opacity-5 rounded-full blur-2xl -mr-10 -mt-10"></div>
                        <h4 class="font-bold text-lg mb-2 relative z-10">Masih Bingung?</h4>
                        <p class="text-sm text-slate-300 mb-4 relative z-10">Tanyakan masalah teknis Anda langsung ke tim komunitas kami.</p>
                        <a href="https://www.instagram.com/ktvdi.id" target="_blank" class="flex items-center justify-center gap-2 w-full bg-white text-brand-navy font-bold py-3 rounded-xl hover:bg-slate-100 transition relative z-10">
                            <i class="fa-brands fa-instagram"></i> DM Instagram
                        </a>
                    </div>
                </div>
            </div>

        </div>
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const channels = [
            {name: "RTV HD-2", url: "https://rtvstream.rtv.co.id:4555/hls/rtv.m3u8"},
            {name: "Matrix TV Jogja", url: "https://stream.matrixtv.id/hls/stream.m3u8"},
            {name: "Berita Satu", url: "https://beritasatu.secureswiftcontent.com/han/beritasatu/bsatu10008/srtoutput/manifest.m3u8"},
            {name: "Nusantara TV", url: "https://nusantaratv.siar.us/nusantaratv/live/playlist.m3u8"},
            {name: "Semarang TV", url: "http://36.94.24.229/0.m3u8"},
            {name: "Caruban TV", url: "https://stream.carubantv.id/hls/stream.m3u8"},
            {name: "Stara TV Malang", url: "https://malang.staratv.id/hls/stream.m3u8"},
            {name: "TVRI Nasional", url: "https://ott-balancer.tvri.go.id/live/eds/Nasional/hls/Nasional.m3u8"},
            {name: "Garuda TV", url: "https://hgmtv.com:19360/garudatvlivestreaming/garudatvlivestreaming.m3u8"},
            {name: "Kompas TV HD", url: "https://www.youtube.com/live/DOOrIxw5xOw?si=JXBIKaInzJ5og-4F", type: "youtube"},
            {name: "Rasika USA TV", url: "https://rasika.siar.us/live/rasika.m3u8"}
        ];

        const grid = document.getElementById('tv-grid');
        
        channels.forEach((ch, idx) => {
            const div = document.createElement('div');
            // MODERN CARD: Dark Theme, Border Halus, Hover Glow
            div.className = "bg-slate-800 rounded-3xl overflow-hidden border border-slate-700/50 hover:border-brand-blue/50 transition-all duration-500 group relative shadow-2xl hover:shadow-brand-blue/10 hover:-translate-y-1";
            
            let playerContent = '';
            
            if (ch.type === "youtube") {
                playerContent = `<iframe src="https://www.youtube.com/embed/DOOrIxw5xOw?autoplay=0&mute=1" class="w-full h-full absolute inset-0 rounded-t-3xl" frameborder="0" allowfullscreen></iframe>`;
            } else {
                playerContent = `
                    <div class="absolute inset-0 flex flex-col items-center justify-center bg-slate-900 z-20 loading-spinner transition-opacity duration-500">
                        <div class="relative">
                            <div class="absolute inset-0 bg-brand-blue blur-xl opacity-20 rounded-full animate-pulse"></div>
                            <img src="{{ url_for('static', filename='icons/icon-192.png') }}" class="w-14 h-auto relative z-10 animate-bounce mb-4 brightness-150 drop-shadow-lg">
                        </div>
                        <span class="text-xs text-brand-sky font-bold tracking-widest uppercase animate-pulse">Memuat Siaran...</span>
                    </div>
                    <video id="vid-${idx}" class="w-full h-full object-cover rounded-t-3xl" controls playsinline muted></video>
                `;
            }

            div.innerHTML = `
                <div class="relative aspect-video bg-black/50">
                    ${playerContent}
                    
                    ${ch.type !== 'youtube' ? `
                    <div class="absolute top-4 left-4 z-30 flex items-center gap-2 bg-black/40 backdrop-blur-md border border-white/10 text-white text-[10px] font-bold px-3 py-1.5 rounded-full shadow-lg">
                        <span class="relative flex h-2 w-2">
                          <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
                          <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span>
                        </span>
                        LIVE
                    </div>` : ''}
                </div>
                
                <div class="p-5 bg-gradient-to-b from-slate-800 to-slate-900 border-t border-white/5">
                    <div class="flex items-center justify-between">
                        <h3 class="font-bold text-white text-base tracking-wide group-hover:text-brand-sky transition-colors">${ch.name}</h3>
                        
                        ${ch.type !== 'youtube' ? `
                        <div class="flex items-center gap-1" title="Sedang Memutar">
                            <div class="w-1 bg-brand-blue rounded-full animate-[wave_1s_ease-in-out_infinite]"></div>
                            <div class="w-1 bg-brand-blue rounded-full animate-[wave_1.2s_ease-in-out_infinite]"></div>
                            <div class="w-1 bg-brand-blue rounded-full animate-[wave_0.8s_ease-in-out_infinite]"></div>
                            <div class="w-1 bg-brand-blue rounded-full animate-[wave_1.1s_ease-in-out_infinite]"></div>
                        </div>` 
                        : '<i class="fa-brands fa-youtube text-red-500 text-xl"></i>'}
                    </div>
                </div>
            `;
            
            grid.appendChild(div);

            if (ch.type !== "youtube") {
                const video = document.getElementById(`vid-${idx}`);
                const spinner = div.querySelector('.loading-spinner');
                
                video.addEventListener('canplay', () => { 
                    spinner.style.opacity = '0'; 
                    setTimeout(() => spinner.remove(), 500); 
                });
                
                video.addEventListener('waiting', () => { 
                    if(spinner) spinner.style.opacity = '1'; 
                });

                if(Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(ch.url);
                    hls.attachMedia(video);
                } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                    video.src = ch.url;
                }
            }
        });
    });
</script>
{% endblock %}
